% vim: spelllang=en_gb

\documentclass[12pt,a4paper,abstract=true,draft]{scrartcl}
\usepackage{ifdraft}

% --------------------
% Set Language Options
% --------------------

\usepackage[nswissgerman,french,main=english]{babel}
\usepackage[autostyle,english=american,german=swiss]{csquotes}
\MakeOuterQuote{"}

\usepackage[shortcuts]{extdash}

% --------------
% Font & Symbols
% --------------

\usepackage{amssymb,mathtools}
\usepackage[warnings-off={mathtools-colon,mathtools-overbracket}]{unicode-math}
\usepackage[oldstyle,proportional]{libertinus-otf}

% ---------------
% Set Page Layout
% ---------------

% Get length of 65 characters
%\setlxvchars

\usepackage[driver=auto]{geometry}
% A5: 148mm × 210mm
% A4: 210mm × 297mm
\geometry{
  width=140mm,
  height=217mm,
  marginparsep=3mm,
  marginparwidth=30mm,
}
\ifdraft{\geometry{
  inner=10mm,
  marginparwidth=50mm
}}{}


% ---------------------
% Load Various Packages
% ---------------------

% Various Math Environments
\usepackage{amsthm,thmtools}

% Bibliography
\usepackage[style=numeric-comp,url=false,isbn=false]{biblatex}
\addbibresource{bibliography.bib}

% For general figures
\usepackage[final]{graphicx}
\graphicspath{{/img}}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{babel,cd,shapes,3d}
\tikzcdset{arrow style=math font}
\tikzset{cross/.style={
    cross out, draw, solid, thin, 
    minimum size=2*(#1-\pgflinewidth), 
    inner sep=0pt, outer sep=0pt
  },
  cross/.default={3}
}

% For lists
\usepackage[shortlabels]{enumitem}

% For better Tables
%\usepackage{tabularray}

% For more fine grained typesetting in final mode.
% Else set the tolerance for overfull warnings higher.
\ifdraft{\hfuzz=1.5pt}{\usepackage{microtype}}

% Links and stuff
\usepackage[final]{hyperref}
\usepackage[noabbrev,capitalize]{cleveref}

% Suppress Latex build info in PDF (for uploads to arxiv)
\hypersetup{
  pdfcreator = {},
  pdfproducer = {}
}
\pdfvariable suppressoptionalinfo \numexpr 1+2+4+8+16+32+64+128+256+512 \relax


% For Todonotes
\usepackage[obeyDraft]{luatodonotes}

% --------------------------------------------
% Define Theorem Environments & Math Operators
% --------------------------------------------

\declaretheorem[numberwithin=section]{theorem}
\declaretheorem[sibling=theorem]{lemma, proposition, corollary}
\declaretheorem[sibling=theorem,style=definition]{definition, example}
\declaretheorem[sibling=theorem,style=remark]{remark}
\declaretheorem[name=Theorem,
refname={Theorem,Theorems},
Refname={Theorem,Theorems}]{maintheorem}
\renewcommand{\themaintheorem}{\Alph{maintheorem}}


\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\interior}{int}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\HF}{HF}
\DeclareMathOperator{\HM}{HM}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Flux}{Flux}
\DeclareMathOperator{\Crit}{Crit}

% ----------------------------
% Various Marcos and Shortcuts
% ----------------------------

\usepackage{physics2} % various shortcuts
\usephysicsmodule{ab,ab.legacy}
\newcommand\mqty[1]{\begin{pmatrix}#1\end{pmatrix}}

\begin{document}
\title{Branch Cut Tangles}
\author{Joel Schmitz}
\maketitle

\section{Thin Branch Cut Tangles}


\begin{definition}
  \label{def:bcs}
  A \textbf{thin branch cut segment} $𝓋 = ([a,b],v,λ)$ is an oriented line segment $[a,b] ⊂ ℝ^n$ labelled with primitive integral vectors $v ∈ ℤ^n$ and $λ ∈ (ℤ^n)^*$ such that $⟨λ,v⟩ = 0$ and that $b-a$ lies in the ray $\{αv \mid α>0\}$.

  We call $𝓋^{-1} = ([b,a],-v,λ)$ the \textbf{reverse} of $𝓋$.
\end{definition}

\begin{definition}
  \label{def:bcs_resolution}
  To a thin branch cut segment $𝓋 = ([a,b],v,λ)$ we associate its \textbf{resolution map} $\overline{𝓋} \colon ℝ^n → ℝ^n$ given by the piecewise affine linear map
  \[\overline{𝓋} x = 
    \begin{cases}
      x - v ⟨λ,x-a⟩ & \text{if } ⟨λ,x-a⟩ ≥ 0 \\
      x             & \text{otherwise}
    \end{cases}
  \]
  or equivalently coordinate\-/wise by the tropical rational functions
  \[(\overline{𝓋}x)_i = \ab(0⊕a^{λ}⊙x^{-λ})^{-v_i} ⊙ x_i \; .\]

  If $𝓊 = ([c,d],u,μ)$ is another thin branch cut segment, we write
  \[\overline{𝓋} 𝓊 = 
    \begin{cases}
      \ab([\overline{𝓋}c, \overline{𝓋}d],
      u - v ⟨λ,u⟩,
      μ + λ ⟨μ,v⟩)
      & \text{if } [c,d] ⊂ \{ x \mid ⟨λ,x-a ⟩ ≥ 0\} \\
      𝓊
      & \text{if } [c,d] ⊂ \{ x \mid ⟨λ,x-a ⟩ ≤ 0\} \\
      \text{undefined} & \text{otherwise}
    \end{cases} \;.\]
\end{definition}

\begin{remark}
  The map $μ ↦ μ + λ ⟨μ,v ⟩$ is the dual-inverse of the linear map $x ↦ x - v ⟨λ,x⟩$.
Note that $\overline{𝓋^{-1}}=\overline{𝓋}^{-1}$.

If $𝓊 = ([c,d],u,μ), 𝓋 =([a,b],v,λ)$ satisfy $[a,b] = [c,d]$ as sets, we say they \textbf{coincide}. In this case $\overline{𝓊}$ and $\overline{𝓋}$ commute.\todo{When do $𝓊$ and $𝓋$ commute?}
\end{remark}

\begin{definition}
  \label{def:stack}
  A \textbf{thin branch cut stack} $𝒮$ at $x ∈ ℝ^n$ of height $m$ is a $m$-tuple of pairs of thin branch cut segments $((𝓋_{01},𝓋_{02}),…,(𝓋_{m1},𝓋_{m2}))$, satisfying the following:
  Write $𝓋_{ij} = ([a_{ij},b_{ij}],v_{ij},λ_{ij})$.
  \begin{enumerate}
    \item $b_{i1} = a_{i2} = x$.
    \item (Top is straight) $v_{01} = v_{02}$ and $λ_{01} = λ_{02}$.
    \item (NCAS\footnote{Node collision avoidance system}) If $⟨λ_{ij},v_{kl} ⟩ = 0$ then $v_{ij}= ± v_{kl}$.
    \item (Reduction) If $m>0$ then $((\overline{𝓋_{01}} 𝓋_{11}, \overline{𝓋_{01}} 𝓋_{12}), …, (\overline{𝓋_{01}} 𝓋_{m1}, \overline{𝓋_{01}} 𝓋_{m2}))$ is a thin branch cut stack of height $m-1$.\label{itm:stack_reduce}
  \end{enumerate}

  Reducing the height of a stack as in \cref{itm:stack_reduce}, we apply the resolution map $u_0 = \overline{𝓋_{01}}$.
  Repeatedly reducing the height until the stack is empty, we successively apply resolution maps
  \[
    u_0 = \overline{𝓋_{01}}\;, \quad
    u_1 = \overline{\overline{𝓋_{01}} 𝓋_{11}}\;, \quad
    …\;, \quad
    u_m = \overline{\overline{\overline{\overline{ 𝓋_{01}} 𝓋_{11}} 𝓋_{21}} … 𝓋_{m1}} \;.
  \]
  The composition $u_m ∘ … ∘ u_1 ∘ u_0$ is called the \textbf{resolution map} of $𝒮$.
\end{definition}

\begin{definition}
  \label{def:bct}
  A \textbf{thin branch cut tangle} $𝒯 ⊂ Δ$ is an embedded directed graph $(C,B)$ where the edges $B$ are thin branch cuts segments, and every vertex $x ∈ C$ belongs to one of the following classes:
  \begin{description}
    \item[Start] $\deg(x) = (0,1)$, $x ∈ Δ^{n-2} ∖ Δ^{n-3}$ with the $n-1$-faces adjacent to $x$ having primitive normal vectors $λ_1,λ_2$ and the outgoing segment $𝓋 = ([x,b],v,λ)$ satisfies $λ = λ_1-λ_2$ and $⟨λ_1,v ⟩ = ⟨ λ_2,v ⟩ = 1$.
    \item[End] $\deg(x) = (m,0)$ and all adjacent edges coincide.
    \item[U-Turn] $\deg(x) = (m,m)$, all adjacent edges coincide and arrange into pairs $𝓋_1, 𝓋_2$ satisfying $𝓋_1^{-1} = 𝓋_2$.
    \item[Stack] $\deg(x) = (m,m)$, and the adjacent edges arrange into a thin branch cut stack of height $m$.
  \end{description}
\end{definition}

\section{Realizing a thin branch cut tangle}

\subsection{Neighbourhood of a focus-focus fibre}

Let $π \colon (X,ω) → O$ be an almost toric fibration.

Then by \cite[Proposition~5.4]{Zun96} the set $N$ of (codimension 2 non-degenerate topologically stable) focus-focus singular values in $B$ is a $n-2$ dimensional submanifold called \textbf{nodes} of $π$.

For some open set $U ⊂ O$, given a covector field $ξ ∈ T^*U$, we get a Hamiltonian $ℝ$-action $φ_ξ^t$ on $π^{-1}(U)$ by the Hamiltonian vector field $ι_{X_ξ} ω = d(f ∘ π) = ξ ∘ Dπ$, as locally we may write $ξ=df$.
We define the \textbf{affine monodromy sheaf} $𝒫$ by setting
\[𝒫(U) = \{ξ ∈ Γ(T^*U) \mid φ_ξ^1 = \id \} \; ,\]
and its dual $𝒫^*$ by
\[𝒫^*(U) = \{ v ∈ Γ(TU) \mid ∀ ξ ∈ 𝒫(U)\colon ξv ∈ ℤ  \} \; .\]

\begin{remark}
  Equivalently, we may also define $𝒫$ as the sheaf of system-preserving Hamiltonian $S¹$-actions, as is quickly verified.
  Thus the $𝒫$ is indeed the same thing as the \emph{affine monodromy sheaf} in \cite{Zun03}.
  The letter $𝒫$ comes from the fact that $𝒫(U)$ marks the periodic Hamiltonian $ℝ$-actions in $T^*U$, in analogy of the \emph{period lattice} (see e.g.\ \cite[Section 1.4]{Eva19}).

  As well as identifying $𝒫(U)$ with system-preserving $S¹$-actions, we may identify $𝒫(U)^k$ with system-preserving $T^k$-actions.
\end{remark}

If $U ⊂ O ∖ N$ (thus only containing regular and elliptic values) is open and contractible, then $𝒫(U) ≅ 𝒫^*(U) ≅ ℤ^n$ and a basis $(ξ_1,…,ξ_n)$ of $𝒫(U)$ locally defines an \textbf{integral affine chart} $f=(f_1,…,f_n)$ up to a constant $c ∈ ℝ^n$ by choosing $df_i = ξ_i$.
In the case where $U$ only contains regular values this is the classical Arnold-Liouville Theorem, the case with elliptic values is treated in e.g.\ \cite{DuMo91}.
See also the discussion around \cite[Theorem 3.9]{Zun96}.
Replacing the smooth atlas of $O ∖ N$ by affine charts, $O ∖ N$ is an integral affine manifold.\footnote{The atlas defined by such charts may not be compatible with the original smooth structure of $O$ near $∂O$…}

While we cannot extend the integral affine structure or action coordinates to $N$, we can at least do so partially:
Let $U ⊂ O$ be open and contractible such that $N ∩ U$ is non-empty and connected.
By \cite[Proposition 5.2 a)]{Zun96} $𝒫(U) ≅ ℤ^{n-1}$ and $𝒫^*(U) ≅ ℤ^{n-1} × ℝ$\todo{$ℝ$ komponente trivial??}.
A basis $(ξ_2,…,ξ_n)$ of $𝒫(U)$ gives rise to $n-1$ action coordinates $(f_2,…,f_n)$.
By \cite[Proposition 5.2 b) and Proposition 5.4 a)]{Zun96}, there is a unique $S¹$-action $λ ∈ 𝒫(U)$ fixing the set of focus-focus singularities in $π^{-1}(U)$ pointwise and which is free elsewhere.
We may choose a basis $(λ=ξ_2,ξ_3,…,ξ_n)$.
Then $(ξ_3, … , ξ_n)$ is a free $T^{n-2}$ action on $U$.
Additionally choose $f_1$ such that $f = (f_1,f_2,…,f_n)$ is locally a chart of $U$.
For a point $n ∈ N ∩ U$, we call such a chart \textbf{almost integral affine chart} at $n$.

While an integral affine chart is unique up to integral affine transform, an almost integral affine chart is unique up to an affine transform with linear part
\[ \mqty{a & 0 & 0 \\ b & 1 & u \\ 0 & 0 & A} \]
where $a,b ∈ ℝ, u^T ∈ ℤ^{n-2}, A ∈ GL(2,ℤ)$.

For any open contractible set $x ⊂ U ∖ N$, the map $T_xO →$
we have there is a vector field $v$ on $V$ such that $ι_v λ = ι_v ζ = 0$ and $ι_v µ = 1$ where $μ ∈ 𝒫(V)$ such that the action $μ ∧ λ ∧ ζ ∈ ⋀^n 𝒫(V) ≅ ℤ$ is free.\todo{Gibts das?}
We say a point $n ∈ N$ is of type $(v,λ)$.

\begin{lemma}[Monodromy]
  In the setting above $π_1(U ∖ N) = ℤ$ and acts on the stalks of $𝒫$ by the linear map \[\id + vλ \;.\]
\end{lemma}

\begin{proof}
  Symplectic reduction along some primitive $ζ ∈ ⋀^{n-2}(𝒫(U))$ reduces this to the 2-dimensional case.
\end{proof}

\begin{lemma}[Nodal slide]

\end{lemma}


\section{Resolution Groups}

Ask Virginie Charette, William Goldman

\end{document}
